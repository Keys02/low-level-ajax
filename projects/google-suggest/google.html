<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href=""><link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABC AIAAACQd1PeAAAADElEQVQI12P4//8/AAX+Av7czFnnAAAAAElFTkSuQmCC">
    <style>
        body {
            font-family: poppins, Helvetica, sans-serif;
            background-color: #efefef;
        }

        #target-div {
            background-color: #ffeeaa;
            width: 30%;
        }
    </style> 
</head>
<body>
    <h1>Google live search<h1>    
    <label>Search for</label>
    <input id="text-field" type="text" name="search-field">

    <div id="target-div"><div><div></div>

    <script>
        let xhr = false
        
        if (window.XMLHttpRequest) {
            xhr = new XMLHttpRequest()
        } else if (window.XActiveObject) {
            xhr = new XActiveObject("Microsoft.XMLHttp")
        } 
        
        let sendRPCDone = (unusedVariable, searchTerm, arrayTerm, arrayResults, unusedArray) => {
            let data = "<table>"
            if (arrayResults.lenth !== 0) {
                arrayResults.forEach((result, index) => {
                data += `
                    <tr>
                        <td>
                            <a href="https://www.google.com/search?q${arrayTerm[index]}>${arrayTerm[index]}</a>
                        </td>
                        <td>${arrayResults[index]}</td>
                    </tr>
                `  
                })
            }
            data += "</table>"
        }

        let getData = (dataSource) => {
            xhr.open('GET', dataSource)

            xhr.addEventListener('readystatechange', () => {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log(xhr)
                    eval(xhr.responseJSON)
                    xhr.send(null)
                }
            })
            xhr.send(null)
        }

        let searchField = document.querySelector("#text-field")

        let getSuggest = (event) => {
            event = event || window.event
            let input = event.target || event.srcElement
            
            if (event.type == "keyup") {
                // let encodedURI = encodeURI("google.php?qu=" + input.value)
                getData("google.php?qu=" + input.value)
                // getData(encodedURI)
            } else {
                let targetDiv = document.querySelector("#target-div")
                targetDiv.innerHTML = "<div></div>" 
            }
        }    
        
        searchField.addEventListener('keyup', getSuggest)
    </script>
</body>
                        